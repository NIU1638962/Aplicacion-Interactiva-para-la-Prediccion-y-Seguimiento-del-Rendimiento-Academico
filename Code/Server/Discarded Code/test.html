<!DOCTYPE html>
<html lang="en" x-data="resultsPage()" x-init="init()">
<head>
  <meta charset="UTF-8" />
  <title>Alpine Loading Debug</title>
  <script src="https://cdn.jsdelivr.net/npm/alpinejs@3.14.8/dist/cdn.min.js" defer></script>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
  <style>
    [x-cloak] { display: none !important; }
  </style>
</head>
<body class="p-4">
  
  <!-- FIX: Remove d-flex from Alpine-controlled element -->
  <div x-cloak x-show="loading" x-transition x-effect="console.log('Loading div visible:', loading)">
    <div class="d-flex align-items-center mb-3">
      <div class="spinner-border text-primary me-3" role="status" aria-hidden="true"></div>
      <p class="mb-0 fs-5 text-secondary">Loading... please wait</p>
    </div>
  </div>

  <div x-cloak x-show="!loading" x-transition x-effect="console.log('Result div visible:', !loading)">
    <h4 class="text-success">Result loaded!</h4>
  </div>

  <script>
    function resultsPage() {
      return {
        loading: true,
        init() {
          console.log('Fetch started, loading:', this.loading);
          setTimeout(() => {
            this.loading = false;
            console.log('Fetch done, loading:', this.loading);
          }, 3000);
        }
      }
    }
  </script>
</body>
</html>
